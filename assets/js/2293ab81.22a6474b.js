"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1877],{1419:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var n=a(3117),i=(a(7294),a(3905));const r={title:"App Template",tags:["testing","e2e","template","infrastructure"]},o=void 0,l={unversionedId:"guides/e2e/app-template",id:"guides/e2e/app-template",title:"App Template",description:"Overview",source:"@site/docs/guides/e2e/01-app-template.md",sourceDirName:"guides/e2e",slug:"/guides/e2e/app-template",permalink:"/guides/e2e/app-template",draft:!1,editUrl:"https://github.com/strapi/strapi/tree/main/docs/docs/guides/e2e/01-app-template.md",tags:[{label:"testing",permalink:"/tags/testing"},{label:"e2e",permalink:"/tags/e-2-e"},{label:"template",permalink:"/tags/template"},{label:"infrastructure",permalink:"/tags/infrastructure"}],version:"current",sidebarPosition:1,frontMatter:{title:"App Template",tags:["testing","e2e","template","infrastructure"]},sidebar:"guides",previous:{title:"Setup",permalink:"/guides/e2e/setup"},next:{title:"Data Transfer",permalink:"/guides/e2e/data-transfer"}},s={},p=[{value:"Overview",id:"overview",level:2},{value:"Content Schemas",id:"content-schemas",level:2},{value:"API Customisations",id:"api-customisations",level:2},{value:"Database",id:"database",level:3},{value:"Usage",id:"usage",level:4},{value:"What does it do?",id:"what-does-it-do",level:4},{value:"Why do we have it?",id:"why-do-we-have-it",level:4},{value:"Config",id:"config",level:3},{value:"Rate Limit",id:"rate-limit",level:4},{value:"Usage",id:"usage-1",level:5},{value:"What does it do?",id:"what-does-it-do-1",level:5},{value:"Why do we have it?",id:"why-do-we-have-it-1",level:5},{value:"Admin Auto Open",id:"admin-auto-open",level:4},{value:"Usage",id:"usage-2",level:5},{value:"What does it do?",id:"what-does-it-do-2",level:5},{value:"Why do we have it?",id:"why-do-we-have-it-2",level:5}],d={toc:p};function u(e){let{components:t,...a}=e;return(0,i.kt)("wrapper",(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"overview"},"Overview"),(0,i.kt)("p",null,"An app template has been created in ",(0,i.kt)("inlineCode",{parentName:"p"},"e2e/app-template")," which provide some customizations and utilities to allow the tests to run. Note that if any changes are made to the app template, you will need to run ",(0,i.kt)("inlineCode",{parentName:"p"},"yarn test:e2e:clean")," to update the test apps with the new template."),(0,i.kt)("p",null,"Here you can read about what content schemas the test instance has & the API customisations we've built (incl. why we built them)."),(0,i.kt)("h2",{id:"content-schemas"},"Content Schemas"),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"There's no content yet!")),(0,i.kt)("h2",{id:"api-customisations"},"API Customisations"),(0,i.kt)("h3",{id:"database"},"Database"),(0,i.kt)("p",null,"found at ",(0,i.kt)("inlineCode",{parentName:"p"},"template/src/api/database")),(0,i.kt)("h4",{id:"usage"},"Usage"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import { test } from '@playwright/test';\n\ntest.beforeEach(async ({ page }) => {\n  await page.request.fetch('http://localhost:1337/api/database/dump', {\n    method: 'POST',\n  });\n});\n")),(0,i.kt)("p",null,"This endpoint does not have a ",(0,i.kt)("inlineCode",{parentName:"p"},"body"),"."),(0,i.kt)("h4",{id:"what-does-it-do"},"What does it do?"),(0,i.kt)("p",null,"This endpoint ",(0,i.kt)("inlineCode",{parentName:"p"},"DELETES")," every row from every table ",(0,i.kt)("em",{parentName:"p"},"excluding"),' the "core" tables \u2013 normally prefixed with ',(0,i.kt)("inlineCode",{parentName:"p"},"strapi_"),"."),(0,i.kt)("h4",{id:"why-do-we-have-it"},"Why do we have it?"),(0,i.kt)("p",null,"This lets us wipe the entire test instance ",(0,i.kt)("em",{parentName:"p"},"if")," we need to. DTS does technically\ndoes this already for us. But nonetheless, its useful."),(0,i.kt)("h3",{id:"config"},"Config"),(0,i.kt)("p",null,"found at ",(0,i.kt)("inlineCode",{parentName:"p"},"template/src/api/config")),(0,i.kt)("h4",{id:"rate-limit"},"Rate Limit"),(0,i.kt)("h5",{id:"usage-1"},"Usage"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"async function toggleRateLimiting(page, enabled = true) {\n  await page.request.fetch('/api/config/ratelimit/enable', {\n    method: 'POST',\n    data: { value: enabled },\n  });\n}\n")),(0,i.kt)("h5",{id:"what-does-it-do-1"},"What does it do?"),(0,i.kt)("p",null,"This endpoint can be used to enable or disable the rate limitting middleware in\nstrapi. When enabled login requests for each user are limitted to 5 in 5 minutes."),(0,i.kt)("h5",{id:"why-do-we-have-it-1"},"Why do we have it?"),(0,i.kt)("p",null,"There are cases where we disable the rate limit to test multiple incorrect login\nattempts."),(0,i.kt)("h4",{id:"admin-auto-open"},"Admin Auto Open"),(0,i.kt)("h5",{id:"usage-2"},"Usage"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"  bootstrap({ strapi }) {\n    strapi.service('api::config.config').adminAutoOpenEnable(false);\n  },\n")),(0,i.kt)("h5",{id:"what-does-it-do-2"},"What does it do?"),(0,i.kt)("p",null,"This endpoint can be used to enable or disable admin auto open."),(0,i.kt)("h5",{id:"why-do-we-have-it-2"},"Why do we have it?"),(0,i.kt)("p",null,"It can be frustrating to work with the e2e tests locally. If auto open is set to\ntrue a browser window will open each time you run the e2e tests as the strapi\napp starts for the first time. Because of this we disable it during the\nbootstrap phase of the test app instance."))}u.isMDXComponent=!0},3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>h});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},d=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=p(a),h=i,m=c["".concat(s,".").concat(h)]||c[h]||u[h]||r;return a?n.createElement(m,o(o({ref:t},d),{},{components:a})):n.createElement(m,o({ref:t},d))}));function h(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,o=new Array(r);o[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var p=2;p<r;p++)o[p]=a[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"}}]);